<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Running unity specific code on the main thread - Forge Networking Remastered</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Running unity specific code on the main thread";
    var mkdocs_page_input_path = "running-unity-specific-code-on-the-main-thread.md";
    var mkdocs_page_url = "/running-unity-specific-code-on-the-main-thread/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Forge Networking Remastered</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <ul class="subnav">
    <li><span>Home</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../authoritative-design/">Authoritative design</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Getting Started</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../getting-started/">Getting started</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../basic-moving-cube-example/">Basic moving cube example</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../basic-rpc-example/">Basic rpc example</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../basic-instantiation-example/">Basic instantiation example</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../jump-start-guide/">Jump start guide</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Network Contract Wizard (NCW)</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../network-contract-wizard-ncw/">Network contract wizard ncw</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../extending-generated-classes/">Extending generated classes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../name-collision-issues/">Name collision issues</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Network Object</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../changing-ownership/">Changing ownership</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../destroying-the-network-object/">Destroying the network object</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../fields/">Fields</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Remote Procedure Calls (RPCs)</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../remote-procedure-calls/">Remote procedure calls</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../buffered-rpcs/">Buffered rpcs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sending-rpc-to-a-single-player/">Sending rpc to a single player</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../rpcargs-and-rpcinfo-structs/">Rpcargs and rpcinfo structs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../rpc-validation-by-server/">Rpc validation by server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../replacing-previous-buffered-rpcs/">Replacing previous buffered rpcs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../clearing-buffered-rpcs/">Clearing buffered rpcs</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Unity Integration</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../gameobject-execution-order/">Gameobject execution order</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../network-instantiation/">Network instantiation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../threading-in-unity/">Threading in unity</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../main-threading-rpcs/">Main threading rpcs</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Running unity specific code on the main thread</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#running-unity-specific-code-on-the-main-thread">Running Unity specific code on the main thread</a></li>
                
                    <li><a class="toctree-l4" href="#mainthreadmanagerrun-function-pointer">MainThreadManager.Run Function Pointer</a></li>
                
                    <li><a class="toctree-l4" href="#mainthreadmanagerrun-lambda-expression">MainThreadManager.Run Lambda Expression</a></li>
                
            
            </ul>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Events</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../connection-cycle-events/">Connection cycle events</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../rewinding/">Rewinding</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Debugging</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../network-logging/">Network logging</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>NetWorker</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../temporarily-blocking-connections/">Temporarily blocking connections</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../thread-safe-player-iteration/">Thread safe player iteration</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../nat-hole-punching/">NAT Hole Punching</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../working-with-multiple-sockets/">Working With Multiple Sockets</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../lan-discovery/">LAN Discovery</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../troubleshooting/">Troubleshooting</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../offline-mode/">Offline Mode</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Contributing</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../adding-and-updating-docs/">Adding and updating docs</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Forge Networking Remastered</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Unity Integration &raquo;</li>
        
      
    
    <li>Running unity specific code on the main thread</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="running-unity-specific-code-on-the-main-thread">Running Unity specific code on the main thread</h1>
<p>We have created a helper class for you to be able to offload any logic to the main thread from a separate thread. This helper class is called <strong>MainT hreadManager</strong> and there are 2 main ways that you can use this class. The entry point for both methods of use is the static method <strong>Run</strong> ; see the code snippets below for practical uses. The examples below emulate a RPC method's contents.</p>
<h3 id="mainthreadmanagerrun-function-pointer">MainThreadManager.Run Function Pointer</h3>
<pre><code class="csharp">public override void MyCustomRPC(object[] args)
{
    // Register the private function within this class to be called on the main thread
    MainThreadManager.Run(OtherFunction);
}

private void OtherFunction()
{
    Debug.Log(&quot;Hello World!&quot;);
}
</code></pre>

<p>You can see that the above example requires another accessible method in order to pass it into the main thread manager's Run method.</p>
<h3 id="mainthreadmanagerrun-lambda-expression">MainThreadManager.Run Lambda Expression</h3>
<pre><code class="csharp">public override void MyCustomRPC(object[] args)
{
    // Setup a temporary method call (lambda expression) to be executed on the main thread
    MainThreadManager.Run(() =&gt; { Debug.Log(&quot;Hello World!&quot;); });
}
</code></pre>

<p><strong>The above is the preferred</strong>  <strong>method</strong></p>
<p>The lambda expression is a native C# feature that allows you to essentially create an inline function at runtime. Please see <a href="http://www.dotnetperls.com/lambda">this website</a> or the <a href="https://msdn.microsoft.com/en-us/library/bb397687.aspx">offi</a> <a href="https://msdn.microsoft.com/en-us/library/bb397687.aspx">cial documentation</a> for more information on lambda expressions.</p>
<p><strong>What does the Main Thread Manager do?</strong></p>
<p>The Main Thread Manager is actually a pretty small and simple singleton class. When you send a method pointer or inline expression into the Run method it will be added to a queue. The Main Thread Manager is a Unity Game Object and will automatically create itself if one is not created already. Every <strong>FixedUpdate</strong> for this object, it will check to see if there are any pending methods in the queue, if so it will run them and remove them from the queue. By running these methods in the <strong>FixedUpdate</strong> they are automatically ran on the main thread.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../connection-cycle-events/" class="btn btn-neutral float-right" title="Connection cycle events">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../main-threading-rpcs/" class="btn btn-neutral" title="Main threading rpcs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../main-threading-rpcs/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../connection-cycle-events/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
