<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Basic moving cube example - Forge Networking Remastered</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Basic moving cube example";
    var mkdocs_page_input_path = "basic-moving-cube-example.md";
    var mkdocs_page_url = "/basic-moving-cube-example/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Forge Networking Remastered</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <ul class="subnav">
    <li><span>Home</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../authoritative-design/">Authoritative design</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Getting Started</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../getting-started/">Getting started</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Basic moving cube example</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#basic-moving-cube-example">Basic Moving Cube Example</a></li>
                
                    <li><a class="toctree-l4" href="#planning-network-code">Planning Network Code</a></li>
                
                    <li><a class="toctree-l4" href="#network-contract-wizard">Network Contract Wizard</a></li>
                
                    <li><a class="toctree-l4" href="#extending-generated-classes">Extending Generated Classes</a></li>
                
                    <li><a class="toctree-l4" href="#scene-setup">Scene Setup</a></li>
                
                    <li><a class="toctree-l4" href="#test">Test</a></li>
                
                    <li><a class="toctree-l4" href="#troubleshooting">Troubleshooting</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../basic-rpc-example/">Basic rpc example</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../basic-instantiation-example/">Basic instantiation example</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../jump-start-guide/">Jump start guide</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Network Contract Wizard (NCW)</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../network-contract-wizard-ncw/">Network contract wizard ncw</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../extending-generated-classes/">Extending generated classes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../name-collision-issues/">Name collision issues</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Network Object</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../changing-ownership/">Changing ownership</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../destroying-the-network-object/">Destroying the network object</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../fields/">Fields</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Remote Procedure Calls (RPCs)</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../remote-procedure-calls/">Remote procedure calls</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../buffered-rpcs/">Buffered rpcs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sending-rpc-to-a-single-player/">Sending rpc to a single player</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../rpcargs-and-rpcinfo-structs/">Rpcargs and rpcinfo structs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../rpc-validation-by-server/">Rpc validation by server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../replacing-previous-buffered-rpcs/">Replacing previous buffered rpcs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../clearing-buffered-rpcs/">Clearing buffered rpcs</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Unity Integration</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../gameobject-execution-order/">Gameobject execution order</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../network-instantiation/">Network instantiation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../threading-in-unity/">Threading in unity</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../main-threading-rpcs/">Main threading rpcs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../running-unity-specific-code-on-the-main-thread/">Running unity specific code on the main thread</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Basic Network Setup Samples</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../server-hosting-code/">Server hosting code</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../client-connecting-code/">Client connecting code</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Events</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../connection-cycle-events/">Connection cycle events</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Scene Navigation</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../loading-scenes/">Loading scenes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../scene-events/">Scene events</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../rewinding/">Rewinding</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Master Server</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../master-server-quick-start/">Master server quick start</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../connecting-to-master-server/">Connecting to master server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../getting-host-list-from-master-server/">Getting host list from master server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../windows-server-firewall-setup/">Windows server firewall setup</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Debugging</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../network-logging/">Network logging</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>NetWorker</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../temporarily-blocking-connections/">Temporarily blocking connections</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../thread-safe-player-iteration/">Thread safe player iteration</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../nat-hole-punching/">NAT Hole Punching</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../working-with-multiple-sockets/">Working With Multiple Sockets</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../lan-discovery/">LAN Discovery</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Troubleshooting</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../troubleshooting/">Troubleshooting</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../throttling-network-internal/">Throttling network internal</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../offline-mode/">Offline Mode</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../lobby/">Lobby System</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Contributing</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../adding-and-updating-docs/">Adding and updating docs</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Forge Networking Remastered</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Getting Started &raquo;</li>
        
      
    
    <li>Basic moving cube example</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="basic-moving-cube-example">Basic Moving Cube Example</h1>
<p><strong>This example is not a continuation of other examples and should be treated as if it were done in a new project.</strong></p>
<p>In this example, we are going to make a simple game where we have a cube in the scene that is owned by the server and all the clients can see it being moved by the server.</p>
<h2 id="planning-network-code">Planning Network Code</h2>
<p>So, one of the first things we want to think about is our <strong>Network Contract</strong>. This is basically a fancy word for how we design/setup network communication. It is helpful to imagine our final result to our application so that we can properly design for it. In this application when a client connects it will see a cube, then the cube will move around in sync with the server, who is the person actually moving the cube. To accomplish this, we need to:</p>
<ol>
<li>Have a cube already in the scene</li>
<li>Synchronize the position and rotation of the cube to all the clients from the server</li>
<li>The transformations should be smooth so we need to interpolate them</li>
</ol>
<h2 id="network-contract-wizard">Network Contract Wizard</h2>
<p>Now that we know that we need to sync the <strong>position</strong> and <strong>rotation</strong> of a cube, we can design our network contract for that object. We will first open the <strong>Network Contract Wizard</strong> which is a UI provided by the Bearded Man Studios team to make it easy to design your <strong>network contracts</strong> in a easy way. To open this menu, go into Unity and select "Window-&gt;Forge Networking-&gt;Network Contract Wizard".</p>
<p><img alt="opening-the-ncw" src="../images/opening-ncw.jpg" title="How to open the NCW" /></p>
<p>Once you have opened this editor you will be presented with a list of all the Network Objects currently available, to learn more about this please see the document on the Network Contract Wizard as we will just be going over how to create a network object through the contract wizard. To start, click on the "Create" button near the top and you will be presented with the create UI. In here, we have 3 major fields of interest, the <strong>Name</strong> fi elds, the <strong>Fields</strong> field, and the <strong>Remote Procedure Calls</strong> field.</p>
<ol>
<li>The <strong>Name</strong> field is where we create the name for our Network Object and behavior, this is a friendly name that should be written in "Pascal case" to follow the C# convention since it is going to be a part of the class names that are generated.</li>
<li>The <strong>Fields</strong> section shows all of the various fields that our network should be aware of. In this case, we are going to want to make a <strong>positi on</strong> and <strong>rotation</strong> field which are <strong>Vector3</strong> and <strong>Quaternion</strong> respectively. <em>Note, you can name these fields whatever you like, these are just friendly variable names for you (and your team) to know what they are for when used</em></li>
<li>The <strong>Remote Procedure Calls</strong> field is where you will design any Remote Procedure Call (RPC) function signatures. We are not going to go over this field in this tutorial as we do not need it for the goal we are attempting to accomplish.</li>
</ol>
<p>Let's begin by naming our Network Object:</p>
<ol>
<li>Let's set the name for our Network object to <strong>BasicCube</strong></li>
<li>Click the <strong>Add Field</strong> button</li>
<li>Name the new field <strong>position</strong></li>
<li>Set the type to <strong>Vector3</strong></li>
<li>Click the <strong>Interpolate</strong> button</li>
<li>Set the interpolate time (the text field that pops up after clicking the <strong>Interpolate</strong> button) as <strong>0.15</strong></li>
<li>Click the <strong>Add Field</strong> button</li>
<li>Name the new field <strong>rotation</strong></li>
<li>Set the type to <strong>Quaternion</strong></li>
<li>Click the <strong>Interpolate</strong> button</li>
<li>Set the interpolate time (the text field that pops up after clicking the <strong>Interpolate</strong> button) as <strong>0.15</strong></li>
<li>Click the <strong>Save &amp; Compile</strong> button</li>
</ol>
<p><img alt="ncw-save-and-compile" src="../images/ncw-save-and-compile.jpg" title="Save &amp; Compile the NCW" /></p>
<h2 id="extending-generated-classes">Extending Generated Classes</h2>
<p>When we use the <strong>Network Contract Wizard (NCW)</strong> we are actually generating a lot of network code based on what has been input into the editor fields, this actually cuts out a lot of work that you would have to do by hand. There is one class in particular that we want to extend from, this class name will be <strong>BasicCubeBehavior</strong>. The naming convention for this generated class is _____Behavior where "_____" is the name we typed into the NCW. Let's now create a C# file in Unity and write our basic game logic, we will name this file <strong>BasicCube</strong>.</p>
<ol>
<li>Open the newly created C# file</li>
<li>Add <strong>using BeardedManStudios.Forge.Networking.Generated;</strong> to the using statements</li>
<li>Derive the class from <strong>BasicCubeBehavior</strong></li>
<li>Write the rest of the logic for the cube as seen below</li>
</ol>
<h3 id="basiccube">BasicCube</h3>
<pre><code class="csharp">using UnityEngine;

using BeardedManStudios.Forge.Networking.Generated;
public class BasicCube : BasicCubeBehavior
{
    /// &lt;summary&gt;
    /// The speed that the cube will move by when the user presses a
    /// Horizontal or Vertical mapped key
    /// &lt;/summary&gt;
    public float speed = 5.0f;

    private void Update()
    {
        // If we are not the owner of this network object then we should
        // move this cube to the position/rotation dictated by the owner
        if (!networkObject.IsOwner)
        {
            transform.position = networkObject.position;
            transform.rotation = networkObject.rotation;
            return;
        }

        // Let the owner move the cube around with the arrow keys
        transform.position += new Vector3(Input.GetAxis(&quot;Horizontal&quot;), Input.GetAxis(&quot;Vertical&quot;), 0.0f) * speed * Time.deltaTime;

        // If we are the owner of the object we should send the new position
        // and rotation across the network for receivers to move to in the above code
        networkObject.position = transform.position;
        networkObject.rotation = transform.rotation;

        // Note: Forge Networking takes care of only sending the delta, so there
        // is no need for you to do that manually
    }
}
</code></pre>

<p>As you can see from the code snippet above, you can determine if the current player is the owner of the object using the <strong>networkObject.IsOwner</strong> boolean comparison. This will allow you to make code specifically based on the owner of the object. In this case, since the cube is going to be in the scene at start, it's owner is the <strong>server</strong>. In the snippet above the client (non owner) will update the transform position and rotation of the cube (the object this script is going to be attached to) to the position and rotation received from the server. Since we turned on interpolation, all of the smoothing is done "behind the scenes". Now the server in this case will just assign the <strong>position</strong> and <strong>rotation</strong> variables of the networkObject. These <strong>are</strong> the two fields we created in the NCW by the way. All generated network objects from the NCW will have a <strong>networkObject</strong> member variable that you can access from the deriving child. Whenever you assign a field of this object it is replicated across the network if the assigning user is the owner of the object.</p>
<h2 id="scene-setup">Scene Setup</h2>
<p>Now that we have done all the network programming required for our end goal, it is time to setup our scene.</p>
<ol>
<li>Create a new scene in unity</li>
<li>Create a cube for your floor</li>
<li>Set the position of this cube on the <strong>x</strong> , <strong>y</strong> , and <strong>z</strong> to <strong>0</strong> , <strong>0</strong> , <strong>0</strong> respectively</li>
<li>Set this cube's scale on the <strong>x</strong> , <strong>y</strong> , and <strong>z</strong> to <strong>25</strong> , <strong>0.1</strong> , <strong>25</strong> respectively</li>
<li>Create another cube which will act as the active moving cube</li>
<li>Set the position of this cube on the <strong>x</strong> , <strong>y</strong> , and <strong>z</strong> to <strong>0</strong> , <strong>3</strong> , <strong>0</strong> respectively</li>
<li>Attach a 3D <strong>Rigidbody</strong> Component to the cube</li>
<li>Attach our <strong>BasicCube</strong> script to this cube</li>
<li>Save the scene as <strong>BasicCube</strong></li>
<li>Open up the build properties for Unity</li>
<li>Add the <strong>MultiplayerMenu</strong> scene as the first scene</li>
<li>Add your <strong>BasicCube</strong> scene as the second scene</li>
</ol>
<h2 id="test">Test</h2>
<p>Now that we have setup our scene and everything else, it is time to test the game.</p>
<ol>
<li>
<p>Open the <strong>Build Settings</strong> 2.  Click on <strong>Player Settings...</strong></p>
</li>
<li>
<p>Open the <strong>Resolution and Presentation</strong> section</p>
</li>
<li>Turn on <strong>Run In Background*</strong></li>
<li>Go back to <strong>Build Settings</strong></li>
<li>Click on <strong>Build And Run</strong></li>
<li>Once the game is open, return to the Unity Editor</li>
<li>Open the <strong>MultiplayerMenu</strong> scene</li>
<li>Click the play button</li>
<li>Click the <strong>Host (127.0.0.1:15937)</strong> button on the bottom of the game view</li>
<li>Go back to the built game</li>
<li>Make sure the host ip address is set to <strong>127.0.0.1</strong></li>
<li>Make sure the host port is set to <strong>15937</strong></li>
<li>Click the <strong>Connect</strong> button</li>
<li>Select the server game instance (Unity Editor)</li>
</ol>
<p>Now if you move around the cube in the editor, you will see the movements replicated to the clients.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p><strong>Getting a null reference exception?</strong>
The most common user errors with this part of the documentation are:
- Forgot to turn on Run in Background*
- Tried pressing the play button in the scene and not loading the Multiplayer Menu scene first
- Not setting up the multiplayer menu scene as index 0 and the demo scene as index 1
<img alt="Common Error Getting Started" src="../images/common-error-getting-started.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../basic-rpc-example/" class="btn btn-neutral float-right" title="Basic rpc example">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../getting-started/" class="btn btn-neutral" title="Getting started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../getting-started/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../basic-rpc-example/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
